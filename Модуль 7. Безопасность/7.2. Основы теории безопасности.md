Однако **базовую безопасность надо настраивать всегда**. Хотя бы потому, что иначе вас могут взломать просто потому, что могут.

Первое, что нужно сделать, когда вы завели себе новый сервер — установить фаервол и закрыть на сервере все порты, кроме тех, которые используются. А вы помните, как смотреть, какие порты используются на сервере?

Например, это можно сделать командой `netstat -tulpn | grep LISTEN`. Те порты, которые будут помечены каким-то адресом, кроме 127.0.0.1, используются для доступа извне.

Вы уже знаете, как закрывать порт через `iptables`. Вспомним на примере порта 22:

iptables -A INPUT -p tcp --dport 22 -j REJECT

Но кроме того, чтобы закрыть все ненужные порты, нужные тоже можно открыть только для определённых адресов. Например, вы хотите подключаться к серверу по _ssh_ из дома. Дома у вас _IP_-адрес 2.2.2.2. Тогда, чтобы открыть доступ только вам и закрыть всем остальным, нужно последовательно выполнить две команды:

iptables -A INPUT -p tcp --dport 22 -s 2.2.2.2 -j ACCEPT
	iptables -A INPUT -p tcp --dport 22 -j REJECT

И потом, конечно, нужно сохранить эти настройки:

iptables-save -f /путь к файлу

После того, как вы закрыли доступ для всех, кроме своего адреса, нужно убедиться, что даже с вашего адреса на сервер можете попасть только вы, а не любой школьник с простейшей программой перебора стандартных паролей (подробнее о хороших паролях мы поговорим в следующем юните).

Но даже самые хорошие пароли могут взломать, поэтому считается хорошей практикой запретить логин под пользователем _root_ вообще. В таком случае, если нужно что-то сделать с максимальными привилегиями, мы используем _sudo_ или, например, переходим в пользователя _root_, предварительно залогинившись под другим аккаунтом. Например:

[myuser@2.2.2.2 ~]$ ssh myuser@1.1.1.1
	[myuser@1.1.1.1 ~]$ sudo -i
	[myuser@1.1.1.1 ~]#

Как обычно, `#` в начале строки означает, что вы залогинены под рутом, а `$` — что не под рутом.

Запретить логин для пользователя _root_ можно разными способами, но самый популярный — следующий:

1. Откройте конфиг `/etc/ssh/sshd_config` (например, редактором `vim` - `vi /etc/ssh/sshd_config`).

2. Измените его так, чтобы там была строка **PermitRootLogin no**. То есть если там уже есть строка с **PermitRootLogin**, надо изменить её значение на **no**, а если нет, то добавить такую строку.

3. Сохраните файл.

4. Перезагрузите службу _sshd_:

     systemctl restart sshd 

Всё, теперь под пользователем _root_ на ваш сервер не зайдёшь.